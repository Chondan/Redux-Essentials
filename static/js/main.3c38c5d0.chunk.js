(this["webpackJsonpredux-essentials-example"]=this["webpackJsonpredux-essentials-example"]||[]).push([[0],{1138:function(e,t){},1141:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(33),s=n.n(c),o=(n(73),n(9)),i=n(4),u=n(1),l=n(19),d=n(7),m=n.n(d),p=n(11),f=n(17),b=n(3),E=n(21),O=n(67);function j(e){return h.apply(this,arguments)}function h(){return(h=Object(f.a)(m.a.mark((function e(t){var n,a,r,c,s,o,i,u=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},a=n.body,r=Object(O.a)(n,["body"]),c={"Content-Type":"application/json"},s=Object(E.a)(Object(E.a)({method:a?"POST":"GET"},r),{},{headers:Object(E.a)(Object(E.a)({},c),r.headers)}),a&&(s.body=JSON.stringify(a)),e.prev=4,e.next=7,window.fetch(t,s);case 7:return i=e.sent,e.next=10,i.json();case 10:if(o=e.sent,!i.ok){e.next=13;break}return e.abrupt("return",o);case 13:throw new Error(i.statusText);case 16:return e.prev=16,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0.message?e.t0.message:o));case 19:case"end":return e.stop()}}),e,null,[[4,16]])})))).apply(this,arguments)}j.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return j(e,Object(E.a)(Object(E.a)({},t),{},{method:"GET"}))},j.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return j(e,Object(E.a)(Object(E.a)({},n),{},{body:t}))};var v,g=Object(b.c)({sortComparer:function(e,t){return t.date.localeCompare(e.date)}}),x=g.getInitialState(),y=Object(b.b)("notifications/fetchNotifications",function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r,c,s,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getState,r=N(a()),c=Object(p.a)(r,1),s=c[0],o=s?s.date:"",e.next=6,j.get("/fakeApi/notifications?since=".concat(o));case 6:return i=e.sent,e.abrupt("return",i.notifications);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),k=Object(b.d)({name:"notifications",initialState:x,reducers:{allNotificationsRead:function(e,t){Object.values(e.entities).forEach((function(e){e.read=!0}))}},extraReducers:Object(l.a)({},y.fulfilled,(function(e,t){Object.values(e.entities).forEach((function(e){e.isNew=!e.read})),g.upsertMany(e,t.payload)}))}),w=k.reducer,S=k.actions.allNotificationsRead,N=g.getSelectors((function(e){return e.notifications})).selectAll,I=function(){var e,t=Object(u.b)(),n=Object(u.c)(N).filter((function(e){return!e.read})).length;n>0&&(e=r.a.createElement("span",{className:"badge"},n));return r.a.createElement("nav",null,r.a.createElement("section",null,r.a.createElement("h1",null,"Redux Essentials Example"),r.a.createElement("div",{className:"navContent"},r.a.createElement("div",{className:"navLinks"},r.a.createElement(o.b,{to:"/Redux-Essentials"},"Posts"),r.a.createElement(o.b,{to:"/Redux-Essentials/users"},"Users"),r.a.createElement(o.b,{to:"/Redux-Essentials/notifications"},"Notifications ",e)),r.a.createElement("button",{className:"button notification-btn",onClick:function(){t(y())}},"Refresh Notifications"))))},C=Object(b.c)(),R=C.getInitialState(),A=Object(b.b)("users/fetchUsers",Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/fakeApi/users");case 2:return t=e.sent,e.abrupt("return",t.users);case 4:case"end":return e.stop()}}),e)})))),T=Object(b.d)({name:"users",initialState:R,reducers:{},extraReducers:Object(l.a)({},A.fulfilled,C.setAll)}).reducer,P=C.getSelectors((function(e){return e.users})),B=P.selectAll,U=P.selectById,D=n(20),F=Object.keys({thumbsUp:"\ud83d\udc4d",hooray:"\ud83c\udf89",heart:"\u2764\ufe0f",rocket:"\ud83d\ude80",eyes:"\ud83d\udc40"}).reduce((function(e,t){return e[t]=0,e}),{}),M=Object(b.c)({sortComparer:function(e,t){return t.date.localeCompare(e.date)}}),L=M.getInitialState({status:"idle",error:null}),q=Object(b.b)("posts/fetchPosts",Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/fakeApi/posts");case 2:return t=e.sent,e.abrupt("return",t.posts);case 4:case"end":return e.stop()}}),e)})))),z=Object(b.b)("posts/addNewPosts",function(){var e=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/fakeApi/posts",{post:t});case 2:return n=e.sent,e.abrupt("return",n.post);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),G=Object(b.d)({name:"posts",initialState:L,reducers:{postAdded:{reducer:function(e,t){e.posts.push(t.payload)},prepare:function(e,t,n){return{payload:{id:Object(b.e)(),title:e,content:t,date:(new Date).toISOString(),user:n,reactions:F}}}},postUpdated:{reducer:function(e,t){var n=t.payload,a=n.id,r=n.title,c=n.content,s=n.date,o=e.entities[a];o.title=r,o.content=c,o.date=s},prepare:function(e,t,n,a){return{payload:{id:e,title:t,content:n,date:a}}}},reactionAdded:{reducer:function(e,t){var n=t.payload,a=n.postId,r=n.emojiName;e.entities[a].reactions[r]++},prepare:function(e,t){return{payload:{postId:e,emojiName:t}}}}},extraReducers:(v={},Object(l.a)(v,q.pending,(function(e,t){e.status="loading"})),Object(l.a)(v,q.fulfilled,(function(e,t){e.status="succeeded",M.upsertMany(e,t.payload)})),Object(l.a)(v,q.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),Object(l.a)(v,z.fulfilled,M.addOne),v)}),J=G.actions,V=G.reducer,H=(J.postAdded,J.postUpdated),K=J.reactionAdded,Q=V,W=M.getSelectors((function(e){return e.posts})),X=W.selectAll,Y=W.selectById,Z=W.selectIds,$=Object(D.a)([X,function(e,t){return t}],(function(e,t){return e.filter((function(e){return e.user===t}))})),_=function(){var e=Object(a.useState)(""),t=Object(p.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(""),o=Object(p.a)(s,2),i=o[0],l=o[1],d=Object(u.b)(),E=Object(a.useState)(""),O=Object(p.a)(E,2),j=O[0],h=O[1],v=Object(u.c)(B).map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})),g=Boolean(n)&&Boolean(i)&&Boolean(j),x=Object(a.useState)("idle"),y=Object(p.a)(x,2),k=y[0],w=y[1],S=function(){var e=Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=18;break}return e.prev=1,w("pending"),e.next=5,d(z({title:n,content:i,user:j}));case 5:t=e.sent,Object(b.f)(t),c(""),l(""),h(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Failed to save the post: ",e.t0);case 15:return e.prev=15,w("idle"),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("section",null,r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"postTitle"},"Title:"),r.a.createElement("input",{type:"text",id:"postTitle",name:"postTitle",value:n,onChange:function(e){return c(e.target.value)}}),r.a.createElement("label",{htmlFor:"postAuthor"},"Post Author:"),r.a.createElement("select",{value:j,onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{value:""}),v),r.a.createElement("label",{htmlFor:"postContent"},"Content:"),r.a.createElement("textarea",{type:"text",id:"postContent",name:"postContent",value:i,onChange:function(e){return l(e.target.value)}}),r.a.createElement("button",{onClick:S,type:"button",disabled:!g},"Add Post")," ",r.a.createElement("span",null,k)))},ee=function(e){var t=e.post,n=Object(u.c)((function(e){return U(e,t.user)}));return r.a.createElement("span",null,"By ",n?n.name:"Unknown Author")},te=n(1143),ne=n(1142),ae=function(e){var t,n=e.timestamp,a=Object(te.a)(n),c=Object(ne.a)(a);return t="".concat(c," ago"),r.a.createElement("span",null," ",r.a.createElement("i",null,t))},re={thumbsUp:"\ud83d\udc4d",hooray:"\ud83c\udf89",heart:"\u2764\ufe0f",rocket:"\ud83d\ude80",eyes:"\ud83d\udc40"},ce=function(e){var t=e.post,n=Object(u.b)(),a=Object.entries(re).map((function(e){var a=Object(p.a)(e,2),c=a[0],s=a[1];return r.a.createElement("button",{type:"button",className:"muted-button reaction-button",key:c,onClick:function(){return e=t.id,void n(K(e,c));var e}},s," ",t.reactions[c])}));return r.a.createElement("div",null,a)},se=function(e){var t=e.postId,n=Object(u.c)((function(e){return Y(e,t)}));return r.a.createElement("article",null,r.a.createElement("h3",null,n.title),r.a.createElement(ee,{post:n}),r.a.createElement(ae,{timestamp:n.date}),r.a.createElement("p",null,n.content.substring(0,40),n.content.length>40?"...":""),r.a.createElement(ce,{post:n}),r.a.createElement(o.b,{to:"/Redux-Essentials/posts/".concat(n.id)},"View Post")," | ",r.a.createElement(o.b,{to:"/Redux-Essentials/editPost/".concat(n.id)},"Edit Post"))};se=r.a.memo(se);var oe=function(){var e=Object(u.c)(Z),t=Object(u.b)(),n=Object(u.c)((function(e){return e.posts.status}));Object(a.useEffect)((function(){"idle"===n&&t(q())}),[n,t]);var c,s=Object(u.c)((function(e){return e.posts.error}));return"loading"===n?c=r.a.createElement("div",{className:"loading"},"Loading..."):"succeeded"===n?c=e.map((function(e){return r.a.createElement(se,{key:e,postId:e})})):"failed"===n&&(c=r.a.createElement("div",null,s)),r.a.createElement("section",null,c)},ie=function(e){var t=e.match.params.postId,n=Object(u.c)((function(e){return Y(e,t)})),a=Object(i.g)();return n?r.a.createElement("section",null,r.a.createElement("article",null,r.a.createElement("h3",null,n.title),r.a.createElement(ee,{post:n}),r.a.createElement(ae,{timestamp:n.date}),r.a.createElement("p",null,n.content),r.a.createElement("span",{style:{cursor:"pointer",color:"blue"},onClick:function(){return a.goBack()}},"Go back"))):r.a.createElement("section",null,r.a.createElement("article",null,r.a.createElement("span",null,"Post Not Found")))},ue=function(e){var t=Object(a.useState)(e||""),n=Object(p.a)(t,2),r=n[0],c=n[1];return[r,function(e){return c(e.target.value)}]},le=function(e){var t=e.match.params.postId,n=Object(u.c)((function(e){return Y(e,t)})),a=ue(n.title),c=Object(p.a)(a,2),s=c[0],o=c[1],l=ue(n.content),d=Object(p.a)(l,2),m=d[0],f=d[1],b=Object(u.b)(),E=Object(i.g)(),O=Boolean(s)&&Boolean(m);return r.a.createElement("section",null,r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"postTitle"},"Title:"),r.a.createElement("input",{type:"text",id:"postTitle",name:"postTitle",value:s,onChange:o}),r.a.createElement("label",{htmlFor:"postConten"},"Content:"),r.a.createElement("textarea",{type:"text",id:"postContent",name:"postContent",value:m,onChange:f}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),b(H(t,s,m,(new Date).toISOString())),E.goBack()},disabled:!O},"Save Post")))},de=function(){var e=Object(u.c)(B).map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(o.b,{to:"/Redux-Essentials/users/".concat(e.id)},e.name))}));return r.a.createElement("section",null,r.a.createElement("h2",null,"Users"),r.a.createElement("ul",null,e))},me=function(e){var t=e.match.params.userId,n=Object(u.c)((function(e){return U(e,t)})),a=Object(u.c)((function(e){return $(e,t)})).map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(o.b,{to:"/Redux-Essentials/posts/".concat(e.id)},e.title))}));return r.a.createElement("section",null,r.a.createElement("h2",null,n.name),r.a.createElement("ul",null,a))},pe=n(56),fe=n.n(pe),be=function(){var e=Object(u.b)(),t=Object(u.c)(N),n=Object(u.c)(B);Object(a.useEffect)((function(){e(S())}));var c=t.map((function(e){var t=Object(te.a)(e.date),a=Object(ne.a)(t),c=n.find((function(t){return t.id===e.user}))||{name:"Unknow User"},s=fe()("notification",{new:e.isNew});return r.a.createElement("div",{key:e.id,className:s},r.a.createElement("div",null,r.a.createElement("b",null,c.name)," ",e.message),r.a.createElement("div",{title:e.date},r.a.createElement("i",null,a)))}));return r.a.createElement("section",null,r.a.createElement("h2",null,"Notifications"),c)};var Ee,Oe=function(){return r.a.createElement(o.a,null,r.a.createElement(I,null),r.a.createElement("div",{className:"App"},r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/Redux-Essentials",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,null),r.a.createElement(oe,null))}}),r.a.createElement(i.b,{path:"/Redux-Essentials/posts/:postId",component:ie}),r.a.createElement(i.b,{path:"/Redux-Essentials/editPost/:postId",component:le}),r.a.createElement(i.b,{exact:!0,path:"/Redux-Essentials/users",component:de}),r.a.createElement(i.b,{path:"/Redux-Essentials/users/:userId",component:me}),r.a.createElement(i.b,{exact:!0,path:"/Redux-Essentials/notifications",component:be}),r.a.createElement(i.a,{to:"/Redux-Essentials"}))))},je=Object(b.a)({reducer:{posts:Q,users:T,notifications:w}}),he=n(66),ve=n(8),ge=n(22),xe=n.n(ge),ye=n(30),ke=n(47),we=n.n(ke),Se=ve.c.extend({serializeIds:"always"}),Ne=we()(),Ie=localStorage.getItem("randomTimestampSeed");function Ce(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Ne()*(t-e+1))+e}Ie?Ee=new Date(Ie):(Ie=(Ee=new Date).toISOString(),localStorage.setItem("randomTimestampSeed",Ie)),Ne=we()(Ie),Object(ye.setRandom)(Ne),xe.a.seed(Ee.getTime());var Re=function(e){return e[Ce(0,e.length-1)]},Ae=["poked you","says hi!","is glad we're friends","sent you a gift"];new ve.d({routes:function(){this.namespace="fakeApi",this.timing=2e3,this.resource("users"),this.resource("posts"),this.resource("comments");var e=this;this.post("/posts",(function(t,n){var a=this.normalizedRequestAttrs();a.date=(new Date).toISOString();var r=t.users.find(a.userId);if(a.user=r,"error"===a.content)throw new Error("Could not save the post!");return e.create("post",a)})),this.get("/posts/:postId/comments",(function(e,t){return e.posts.find(t.params.postId).comments})),this.get("/notifications",(function(e,t){var n,a=Ce(1,5),r=new Date;return t.queryParams.since?n=Object(te.a)(t.queryParams.since):(n=new Date(r.valueOf())).setMinutes(n.getMinutes()-15),{notifications:Object(he.a)(Array(a)).map((function(){var t=Re(e.db.users),a=Re(Ae);return{id:Object(b.e)(),date:xe.a.date.between(n,r).toISOString(),message:a,user:t.id,read:!1,isNew:!0}}))}}))},models:{user:ve.b.extend({posts:Object(ve.g)()}),post:ve.b.extend({user:Object(ve.f)(),comments:Object(ve.g)()}),comment:ve.b.extend({post:Object(ve.f)()}),notification:ve.b.extend({})},factories:{user:ve.a.extend({id:function(){return Object(b.e)()},firstName:function(){return xe.a.name.firstName()},lastName:function(){return xe.a.name.lastName()},name:function(){return xe.a.name.findName(this.firstName,this.lastName)},username:function(){return xe.a.internet.userName(this.firstName,this.lastName)},afterCreate:function(e,t){t.createList("post",3,{user:e})}}),post:ve.a.extend({id:function(){return Object(b.e)()},title:function(){return Object(ye.sentence)()},date:function(){return xe.a.date.recent(7)},content:function(){return Object(ye.article)(1)},reactions:function(){return{thumbsUp:0,hooray:0,heart:0,rocket:0,eyes:0}},afterCreate:function(e,t){},user:Object(ve.e)()}),comment:ve.a.extend({id:function(){return Object(b.e)()},date:function(){return xe.a.date.past(2)},text:function(){return Object(ye.paragraph)()},post:Object(ve.e)()})},serializers:{user:Se,post:Se,comment:Se},seeds:function(e){e.createList("user",3)}}),je.dispatch(A()),s.a.render(r.a.createElement(u.a,{store:je},r.a.createElement(r.a.StrictMode,null,r.a.createElement(Oe,null))),document.getElementById("root"))},68:function(e,t,n){e.exports=n(1141)},73:function(e,t,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.3c38c5d0.chunk.js.map